<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DIN√ÅMICAS BOMBA - Pro</title>

<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
/* ======= TU CSS ORIGINAL SIN CAMBIOS ======= */
:root{
--primary:#6366f1;--secondary:#a855f7;--accent:#f43f5e;
--glass:rgba(255,255,255,.05);--glass-border:rgba(255,255,255,.1);
--text-main:#f8fafc;--color-libre:rgba(255,255,255,.03);
--color-seleccionado:#6366f1;--color-apartado:#fbbf24;--color-pagado:#22c55e
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Plus Jakarta Sans',sans-serif}
body{background:radial-gradient(circle at top right,#0f172a,#020617);color:var(--text-main);min-height:100vh;padding:15px}
header,.panel,.admin-card{background:var(--glass);backdrop-filter:blur(15px);border:1px solid var(--glass-border);border-radius:24px;padding:20px;margin-bottom:20px}
h1{background:linear-gradient(to right,#fbbf24,#22c55e);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:2rem;font-weight:800;text-align:center}
.hidden{display:none!important}
.btn{padding:12px 20px;border-radius:12px;border:none;font-weight:700;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
.btn-primary{background:var(--primary);color:#fff}
.btn-success{background:#22c55e;color:#fff;width:100%;justify-content:center}
input{background:rgba(0,0,0,.4);border:1px solid var(--glass-border);padding:12px;border-radius:12px;color:white;width:100%}
.numbers-container{height:400px;overflow-y:auto;padding:15px;background:rgba(0,0,0,.3);border-radius:18px;border:1px solid var(--glass-border)}
.numbers-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(50px,1fr));gap:8px}
.number-item{aspect-ratio:1;background:var(--color-libre);border:1px solid var(--glass-border);border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700;cursor:pointer;font-size:.7rem;color:#94a3b8}
.number-item.selected{background:var(--color-seleccionado);color:white}
.number-item.apartado{background:var(--color-apartado);color:#000}
.number-item.pagado{background:var(--color-pagado);color:#fff;cursor:not-allowed}
</style>
</head>

<body>

<div class="container" style="max-width:900px;margin:auto">

<header>
<h1>DIN√ÅMICAS BOMBA</h1>
<div style="display:flex;justify-content:center;gap:8px;margin-top:15px">
<button class="btn btn-primary" onclick="showTab('user')">üéü Sorteo</button>
<button class="btn btn-primary" onclick="showTab('admin-login')">üîê Admin</button>
</div>
</header>

<!-- USUARIO -->
<div id="view-user">
<div class="panel">
<h2 id="displayPrizeTitle"></h2>
<img id="displayPrizeImg" style="width:100%;height:220px;object-fit:cover;border-radius:15px;margin:15px 0">
<p id="displayPrizeDesc"></p>
<h3>Boleto: <span id="displayPrice"></span> COP</h3>
</div>

<div class="panel">
<div class="numbers-container">
<div class="numbers-grid" id="mainGrid"></div>
</div>
</div>

<div class="panel">
<input id="uNombre" placeholder="Nombre">
<input id="uApellido" placeholder="Apellido" style="margin:8px 0">
<input id="uCelular" placeholder="Celular">
<div id="selectionSummary" style="margin:15px 0;font-weight:800;color:#fbbf24;text-align:center"></div>
<button class="btn btn-success" onclick="sendWhatsApp()">Enviar por WhatsApp</button>
</div>
</div>

<!-- LOGIN ADMIN -->
<div id="view-admin-login" class="hidden">
<div class="admin-card" style="max-width:350px;margin:auto">
<h2>Admin</h2>
<input type="email" id="adminEmail" placeholder="Email admin">
<input type="password" id="adminPass" placeholder="Contrase√±a" style="margin:10px 0">
<button class="btn btn-primary" style="width:100%" onclick="loginAdmin()">Entrar</button>
</div>
</div>

<!-- PANEL ADMIN -->
<div id="view-admin-panel" class="hidden">
<div class="panel">
<h3>Panel Admin</h3>
<button class="btn" style="background:#475569;color:white" onclick="logoutAdmin()">Cerrar sesi√≥n</button>
</div>
</div>

</div>

<script>
function showTab(tab){
['view-user','view-admin-login','view-admin-panel'].forEach(v=>{
document.getElementById(v).classList.add('hidden')
})
document.getElementById('view-'+tab).classList.remove('hidden')
}
</script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut }
from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";
import { getFirestore, doc, getDoc, setDoc, onSnapshot }
from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

const firebaseConfig={
apiKey:"AIzaSyC8j6OmhdGkyF_Jw0Fz88BG0fWuixnY-EY",
authDomain:"sbdinamicas-2025.firebaseapp.com",
projectId:"sbdinamicas-2025"
};

const app=initializeApp(firebaseConfig)
const auth=getAuth(app)
const db=getFirestore(app)
const ref=doc(db,"sorteos","principal")

let data={prize:"Gran Sorteo",desc:"Participa",price:0,img:"",soldNumbers:{}}

const snap=await getDoc(ref)
if(!snap.exists()) await setDoc(ref,data)
else data=snap.data()

function initGrid(){
const g=document.getElementById("mainGrid")
g.innerHTML=""
for(let i=0;i<1000;i++){
const n=i.toString().padStart(3,"0")
const d=document.createElement("div")
d.textContent=n
d.className="number-item"
if(data.soldNumbers[n]) d.classList.add(data.soldNumbers[n].pagado?"pagado":"apartado")
g.appendChild(d)
}
}

function updateUI(){
displayPrizeTitle.textContent=data.prize
displayPrizeDesc.textContent=data.desc
displayPrice.textContent=data.price
displayPrizeImg.src=data.img
}

onSnapshot(ref,s=>{
data=s.data()
initGrid()
updateUI()
})

window.loginAdmin=async()=>{
await signInWithEmailAndPassword(auth,adminEmail.value,adminPass.value)
showTab("admin-panel")
}

window.logoutAdmin=async()=>{
await signOut(auth)
showTab("user")
}

onAuthStateChanged(auth,u=>{
if(!u) showTab("user")
})
</script>
</body>
</html>